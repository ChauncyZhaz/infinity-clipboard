<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Êó†ÈôêÂâ™Ë¥¥Êùø - Infinity Clipboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f5f5f5;
            overflow: hidden;
            height: 100vh;
        }

        /* È°∂ÈÉ®Â∑•ÂÖ∑Ê†è */
        .toolbar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 60px;
            background: #2c3e50;
            color: white;
            display: flex;
            align-items: center;
            padding: 0 20px;
            z-index: 1000;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .toolbar h1 {
            font-size: 18px;
            margin-right: 30px;
        }

        .search-container {
            flex: 1;
            max-width: 400px;
            margin: 0 20px;
        }

        .search-input {
            width: 100%;
            padding: 8px 12px;
            border: none;
            border-radius: 20px;
            background: #34495e;
            color: white;
            font-size: 14px;
        }

        .search-input::placeholder {
            color: #bdc3c7;
        }

        .toolbar-buttons {
            display: flex;
            gap: 10px;
        }

        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
        }

        .btn-primary {
            background: #3498db;
            color: white;
        }

        .btn-primary:hover {
            background: #2980b9;
        }

        .btn-secondary {
            background: #95a5a6;
            color: white;
        }

        .btn-secondary:hover {
            background: #7f8c8d;
        }

        /* ‰∏ªÁîªÂ∏ÉÂå∫Âüü */
        .canvas-container {
            position: absolute;
            top: 60px;
            left: 0;
            right: 0;
            bottom: 0;
            overflow: auto;
            background: #ecf0f1;
        }

        .canvas {
            position: relative;
            min-width: 100%;
            min-height: 100%;
            padding: 20px;
        }

        /* ÁΩëÊ†ºÂ∏ÉÂ±Ä */
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            padding: 20px;
        }

        /* Ââ™Ë¥¥ÊùøÈ°πÁõÆ */
        .clipboard-item {
            background: white;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            transition: all 0.3s;
            position: relative;
            min-height: 100px;
        }

        .clipboard-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
        }

        .clipboard-item.highlight {
            background: #fff3cd;
            border: 2px solid #ffc107;
        }

        .item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }

        .item-type {
            font-size: 12px;
            color: #666;
            text-transform: uppercase;
            font-weight: bold;
        }

        .item-actions {
            display: flex;
            gap: 5px;
        }

        .action-btn {
            padding: 4px 8px;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            font-size: 12px;
            background: #f8f9fa;
            color: #666;
        }

        .action-btn:hover {
            background: #e9ecef;
        }

        .item-content {
            word-wrap: break-word;
        }

        .text-content {
            font-size: 14px;
            line-height: 1.5;
            color: #333;
        }

        .code-content {
            background: #f8f9fa;
            border-radius: 4px;
            padding: 10px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            line-height: 1.4;
            overflow-x: auto;
        }

        .image-content img {
            max-width: 100%;
            height: auto;
            border-radius: 4px;
            cursor: pointer;
        }

        .image-content img:hover {
            opacity: 0.8;
        }

        .item-timestamp {
            font-size: 11px;
            color: #999;
            margin-top: 10px;
        }

        /* ‰ª£Á†ÅËØ≠Ë®ÄÈÄâÊã©Âô® */
        .language-selector {
            position: absolute;
            top: 5px;
            right: 5px;
            background: white;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 4px;
            font-size: 12px;
        }

        /* Á©∫Áä∂ÊÄÅ */
        .empty-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            color: #666;
            text-align: center;
        }

        .empty-state h2 {
            margin-bottom: 10px;
            color: #333;
        }

        .empty-state p {
            margin-bottom: 20px;
        }

        /* ÊèêÁ§∫Ê°Ü */
        .tooltip {
            position: fixed;
            background: #333;
            color: white;
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 12px;
            z-index: 1001;
            pointer-events: none;
        }

        /* ÂìçÂ∫îÂºèËÆæËÆ° */
        @media (max-width: 768px) {
            .toolbar {
                padding: 0 10px;
            }
            
            .toolbar h1 {
                font-size: 16px;
                margin-right: 15px;
            }
            
            .search-container {
                margin: 0 10px;
            }
            
            .grid {
                grid-template-columns: 1fr;
                gap: 15px;
                padding: 15px;
            }
        }

        /* ÊªöÂä®Êù°Ê†∑Âºè */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }

        ::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
    </style>
</head>
<body>
    <!-- È°∂ÈÉ®Â∑•ÂÖ∑Ê†è -->
    <div class="toolbar">
        <h1>üìã Êó†ÈôêÂâ™Ë¥¥Êùø</h1>
        
        <div class="search-container">
            <input type="text" class="search-input" placeholder="ÊêúÁ¥¢Ââ™Ë¥¥ÊùøÂÜÖÂÆπ..." id="searchInput">
        </div>
        
        <div class="toolbar-buttons">
            <button class="btn btn-primary" onclick="clearAll()">Ê∏ÖÁ©∫ÂÖ®ÈÉ®</button>
            <button class="btn btn-secondary" onclick="exportData()">ÂØºÂá∫Êï∞ÊçÆ</button>
            <button class="btn btn-secondary" onclick="importData()">ÂØºÂÖ•Êï∞ÊçÆ</button>
            <button class="btn btn-secondary" onclick="showHelp()" title="‰ΩøÁî®Â∏ÆÂä©">‚ùì</button>
        </div>
    </div>

    <!-- ‰∏ªÁîªÂ∏ÉÂå∫Âüü -->
    <div class="canvas-container">
        <div class="canvas">
            <div class="grid" id="clipboardGrid">
                <!-- Ââ™Ë¥¥ÊùøÈ°πÁõÆÂ∞ÜÂú®ËøôÈáåÂä®ÊÄÅÁîüÊàê -->
            </div>
        </div>
    </div>

    <!-- ÊèêÁ§∫Ê°Ü -->
    <div class="tooltip" id="tooltip" style="display: none;"></div>

    <script>
        // ÂÖ®Â±ÄÂèòÈáè
        let clipboardItems = [];
        let currentSearchTerm = '';
        let nextId = 1;

        // ÂàùÂßãÂåñÂ∫îÁî®
        document.addEventListener('DOMContentLoaded', function() {
            loadClipboardData();
            setupEventListeners();
            renderClipboardItems();
        });

        // ËÆæÁΩÆ‰∫ã‰ª∂ÁõëÂê¨Âô®
        function setupEventListeners() {
            // Á≤òË¥¥‰∫ã‰ª∂
            document.addEventListener('paste', handlePaste);
            
            // ÊêúÁ¥¢‰∫ã‰ª∂
            document.getElementById('searchInput').addEventListener('input', handleSearch);
            
            // ÈîÆÁõòÂø´Êç∑ÈîÆ
            document.addEventListener('keydown', handleKeyboardShortcuts);
            
            // ÁÇπÂáª‰∫ã‰ª∂ÂßîÊâò
            document.getElementById('clipboardGrid').addEventListener('click', handleGridClick);
            
            // Âè≥ÈîÆËèúÂçï‰∫ã‰ª∂
            document.addEventListener('contextmenu', handleContextMenu);
        }

        // Â§ÑÁêÜÁ≤òË¥¥‰∫ã‰ª∂
        function handlePaste(event) {
            event.preventDefault();
            
            const clipboardData = event.clipboardData;
            if (!clipboardData) return;

            // Â§ÑÁêÜÂõæÁâá
            if (clipboardData.files.length > 0) {
                const file = clipboardData.files[0];
                if (file.type.startsWith('image/')) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        addClipboardItem({
                            type: 'image',
                            content: e.target.result,
                            timestamp: new Date()
                        });
                    };
                    reader.readAsDataURL(file);
                    return;
                }
            }

            // Â§ÑÁêÜÊñáÊú¨
            const text = clipboardData.getData('text/plain');
            if (text) {
                // Ê£ÄÊµãÊòØÂê¶‰∏∫‰ª£Á†Å
                const isCode = detectCode(text);
                addClipboardItem({
                    type: isCode ? 'code' : 'text',
                    content: text,
                    language: isCode ? detectLanguage(text) : null,
                    timestamp: new Date()
                });
            }
        }

        // Ê£ÄÊµãÊòØÂê¶‰∏∫‰ª£Á†Å
        function detectCode(text) {
            const codePatterns = [
                /function\s+\w+\s*\(/,
                /if\s*\(.*\)\s*{/,
                /for\s*\(.*\)\s*{/,
                /while\s*\(.*\)\s*{/,
                /import\s+.*from/,
                /require\s*\(/,
                /console\.log/,
                /class\s+\w+/,
                /def\s+\w+/,
                /public\s+class/,
                /private\s+\w+/,
                /protected\s+\w+/,
                /<html>/i,
                /<!DOCTYPE/i,
                /<script>/i,
                /<style>/i
            ];
            
            return codePatterns.some(pattern => pattern.test(text));
        }

        // Ê£ÄÊµã‰ª£Á†ÅËØ≠Ë®Ä
        function detectLanguage(text) {
            if (text.includes('function') && text.includes('console.log')) return 'javascript';
            if (text.includes('import') && text.includes('from')) return 'javascript';
            if (text.includes('def ') && text.includes(':')) return 'python';
            if (text.includes('public class') || text.includes('private ')) return 'java';
            if (text.includes('<html>') || text.includes('<!DOCTYPE')) return 'html';
            if (text.includes('<script>')) return 'javascript';
            if (text.includes('<style>')) return 'css';
            if (text.includes('function') && text.includes('{')) return 'javascript';
            return 'text';
        }

        // Ê∑ªÂä†Ââ™Ë¥¥ÊùøÈ°πÁõÆ
        function addClipboardItem(item) {
            item.id = nextId++;
            clipboardItems.unshift(item);
            saveClipboardData();
            renderClipboardItems();
            showTooltip('ÂÜÖÂÆπÂ∑≤Ê∑ªÂä†Âà∞Ââ™Ë¥¥ÊùøÔºÅ');
        }

        // Ê∏≤ÊüìÂâ™Ë¥¥ÊùøÈ°πÁõÆ
        function renderClipboardItems() {
            const grid = document.getElementById('clipboardGrid');
            const filteredItems = filterItems(clipboardItems, currentSearchTerm);
            
            if (filteredItems.length === 0) {
                grid.innerHTML = `
                    <div class="empty-state">
                        <h2>üìã Êó†ÈôêÂâ™Ë¥¥Êùø</h2>
                        <p>ËøòÊ≤°Êúâ‰ªª‰ΩïÂÜÖÂÆπÔºåËØïËØïÁ≤òË¥¥‰∏Ä‰∫õÊñáÊú¨„ÄÅ‰ª£Á†ÅÊàñÂõæÁâáÂêßÔºÅ</p>
                        <p>üí° ÊèêÁ§∫Ôºö‰ΩøÁî® Ctrl+V Á≤òË¥¥ÂÜÖÂÆπ</p>
                    </div>
                `;
                return;
            }

            grid.innerHTML = filteredItems.map(item => createItemHTML(item)).join('');
        }

        // ÂàõÂª∫È°πÁõÆHTML
        function createItemHTML(item) {
            const timestamp = new Date(item.timestamp).toLocaleString('zh-CN');
            const content = escapeHtml(item.content);
            
            let contentHTML = '';
            if (item.type === 'image') {
                contentHTML = `<div class="image-content"><img src="${content}" alt="Á≤òË¥¥ÁöÑÂõæÁâá"></div>`;
            } else if (item.type === 'code') {
                contentHTML = `
                    <div class="code-content">${content}</div>
                    <select class="language-selector" onchange="changeLanguage(${item.id}, this.value)">
                        <option value="text" ${item.language === 'text' ? 'selected' : ''}>ÊñáÊú¨</option>
                        <option value="javascript" ${item.language === 'javascript' ? 'selected' : ''}>JavaScript</option>
                        <option value="python" ${item.language === 'python' ? 'selected' : ''}>Python</option>
                        <option value="java" ${item.language === 'java' ? 'selected' : ''}>Java</option>
                        <option value="html" ${item.language === 'html' ? 'selected' : ''}>HTML</option>
                        <option value="css" ${item.language === 'css' ? 'selected' : ''}>CSS</option>
                    </select>
                `;
            } else if (item.type === 'image') {
                contentHTML = `
                    <div class="image-content">
                        <img src="${content}" alt="Á≤òË¥¥ÁöÑÂõæÁâá" title="Âè≥ÈîÆÁÇπÂáªÂõæÁâáÊü•ÁúãÊõ¥Â§öÈÄâÈ°π">
                    </div>
                    <div style="font-size: 11px; color: #666; margin-top: 5px;">
                        üí° ÊèêÁ§∫ÔºöÂè≥ÈîÆÁÇπÂáªÂõæÁâáÂèØÂ§çÂà∂ÂõæÁâáÂà∞Ââ™Ë¥¥Êùø
                    </div>
                `;
            } else {
                contentHTML = `<div class="text-content">${content}</div>`;
            }

            return `
                <div class="clipboard-item" data-id="${item.id}">
                    <div class="item-header">
                        <span class="item-type">${getTypeIcon(item.type)} ${item.type}</span>
                        <div class="item-actions">
                            <button class="action-btn" onclick="copyToClipboard('${escapeHtml(item.content)}', '${item.type}')" title="Â§çÂà∂Âà∞Ââ™Ë¥¥Êùø">üìã</button>
                            <button class="action-btn" onclick="deleteItem(${item.id})" title="Âà†Èô§">üóëÔ∏è</button>
                        </div>
                    </div>
                    <div class="item-content">
                        ${contentHTML}
                    </div>
                    <div class="item-timestamp">${timestamp}</div>
                </div>
            `;
        }

        // Ëé∑ÂèñÁ±ªÂûãÂõæÊ†á
        function getTypeIcon(type) {
            const icons = {
                'text': 'üìù',
                'code': 'üíª',
                'image': 'üñºÔ∏è'
            };
            return icons[type] || 'üìÑ';
        }

        // ËøáÊª§È°πÁõÆ
        function filterItems(items, searchTerm) {
            if (!searchTerm) return items;
            
            return items.filter(item => {
                const content = item.content.toLowerCase();
                const search = searchTerm.toLowerCase();
                return content.includes(search);
            });
        }

        // Â§ÑÁêÜÊêúÁ¥¢
        function handleSearch(event) {
            currentSearchTerm = event.target.value;
            renderClipboardItems();
        }

        // Â§çÂà∂Âà∞Ââ™Ë¥¥Êùø
        async function copyToClipboard(content, type = 'text') {
            try {
                if (type === 'image') {
                    // Â§çÂà∂ÂõæÁâáÂà∞Ââ™Ë¥¥Êùø
                    const response = await fetch(content);
                    const blob = await response.blob();
                    await navigator.clipboard.write([
                        new ClipboardItem({
                            [blob.type]: blob
                        })
                    ]);
                    showTooltip('ÂõæÁâáÂ∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥ÊùøÔºÅ');
                } else {
                    // Â§çÂà∂ÊñáÊú¨Âà∞Ââ™Ë¥¥Êùø
                    await navigator.clipboard.writeText(content);
                    showTooltip('Â∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥ÊùøÔºÅ');
                }
            } catch (err) {
                console.error('Â§çÂà∂Â§±Ë¥•:', err);
                if (type === 'image') {
                    // ÂõæÁâáÂ§çÂà∂Â§±Ë¥•Êó∂ÁöÑÈôçÁ∫ßÊñπÊ°à
                    showTooltip('ÂõæÁâáÂ§çÂà∂Â§±Ë¥•ÔºåËØ∑Âè≥ÈîÆ‰øùÂ≠òÂõæÁâá');
                } else {
                    // ÊñáÊú¨Â§çÂà∂Â§±Ë¥•Êó∂ÁöÑÈôçÁ∫ßÊñπÊ°à
                    const textArea = document.createElement('textarea');
                    textArea.value = content;
                    document.body.appendChild(textArea);
                    textArea.select();
                    document.execCommand('copy');
                    document.body.removeChild(textArea);
                    showTooltip('Â∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥ÊùøÔºÅ');
                }
            }
        }

        // Âà†Èô§È°πÁõÆ
        function deleteItem(id) {
            clipboardItems = clipboardItems.filter(item => item.id !== id);
            saveClipboardData();
            renderClipboardItems();
            showTooltip('È°πÁõÆÂ∑≤Âà†Èô§ÔºÅ');
        }

        // Ê∏ÖÁ©∫ÂÖ®ÈÉ®
        function clearAll() {
            if (confirm('Á°ÆÂÆöË¶ÅÊ∏ÖÁ©∫ÊâÄÊúâÂâ™Ë¥¥ÊùøÂÜÖÂÆπÂêóÔºü')) {
                clipboardItems = [];
                saveClipboardData();
                renderClipboardItems();
                showTooltip('ÊâÄÊúâÂÜÖÂÆπÂ∑≤Ê∏ÖÁ©∫ÔºÅ');
            }
        }

        // ÂØºÂá∫Êï∞ÊçÆ
        function exportData() {
            const data = JSON.stringify(clipboardItems, null, 2);
            const blob = new Blob([data], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `clipboard-data-${new Date().toISOString().slice(0, 10)}.json`;
            a.click();
            URL.revokeObjectURL(url);
            showTooltip('Êï∞ÊçÆÂ∑≤ÂØºÂá∫ÔºÅ');
        }

        // ÂØºÂÖ•Êï∞ÊçÆ
        function importData() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            input.onchange = function(event) {
                const file = event.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        try {
                            const importedData = JSON.parse(e.target.result);
                            clipboardItems = importedData;
                            nextId = Math.max(...clipboardItems.map(item => item.id), 0) + 1;
                            saveClipboardData();
                            renderClipboardItems();
                            showTooltip('Êï∞ÊçÆÂ∑≤ÂØºÂÖ•ÔºÅ');
                        } catch (error) {
                            alert('ÂØºÂÖ•Â§±Ë¥•ÔºöÊñá‰ª∂Ê†ºÂºè‰∏çÊ≠£Á°Æ');
                        }
                    };
                    reader.readAsText(file);
                }
            };
            input.click();
        }

        // ÊîπÂèò‰ª£Á†ÅËØ≠Ë®Ä
        function changeLanguage(id, language) {
            const item = clipboardItems.find(item => item.id === id);
            if (item) {
                item.language = language;
                saveClipboardData();
            }
        }

        // Â§ÑÁêÜÈîÆÁõòÂø´Êç∑ÈîÆ
        function handleKeyboardShortcuts(event) {
            // Ctrl+V Â∑≤ÁªèÂú®Á≤òË¥¥‰∫ã‰ª∂‰∏≠Â§ÑÁêÜ
            if (event.ctrlKey && event.key === 'f') {
                event.preventDefault();
                document.getElementById('searchInput').focus();
            }
            if (event.ctrlKey && event.key === 'a') {
                event.preventDefault();
                // ÂÖ®ÈÄâÂΩìÂâçÈ°πÁõÆÔºàÂ¶ÇÊûúÈúÄË¶ÅÁöÑËØùÔºâ
            }
            if (event.key === 'Escape') {
                document.getElementById('searchInput').value = '';
                currentSearchTerm = '';
                renderClipboardItems();
            }
        }

        // Â§ÑÁêÜÁΩëÊ†ºÁÇπÂáª‰∫ã‰ª∂
        function handleGridClick(event) {
            const item = event.target.closest('.clipboard-item');
            if (item && event.target.classList.contains('clipboard-item')) {
                // ÁÇπÂáªÈ°πÁõÆÊó∂Â§çÂà∂ÂÜÖÂÆπ
                const id = parseInt(item.dataset.id);
                const clipboardItem = clipboardItems.find(item => item.id === id);
                if (clipboardItem) {
                    copyToClipboard(clipboardItem.content, clipboardItem.type);
                }
            }
        }

        // Â§ÑÁêÜÂè≥ÈîÆËèúÂçï
        function handleContextMenu(event) {
            const img = event.target.closest('.image-content img');
            if (img) {
                event.preventDefault();
                const item = img.closest('.clipboard-item');
                const id = parseInt(item.dataset.id);
                const clipboardItem = clipboardItems.find(item => item.id === id);
                
                if (clipboardItem && clipboardItem.type === 'image') {
                    showImageContextMenu(event, clipboardItem);
                }
            }
        }

        // ÊòæÁ§∫ÂõæÁâáÂè≥ÈîÆËèúÂçï
        function showImageContextMenu(event, clipboardItem) {
            // ÁßªÈô§Áé∞ÊúâÁöÑÂè≥ÈîÆËèúÂçï
            const existingMenu = document.getElementById('contextMenu');
            if (existingMenu) {
                existingMenu.remove();
            }

            const menu = document.createElement('div');
            menu.id = 'contextMenu';
            menu.style.cssText = `
                position: fixed;
                top: ${event.clientY}px;
                left: ${event.clientX}px;
                background: white;
                border: 1px solid #ddd;
                border-radius: 4px;
                box-shadow: 0 2px 10px rgba(0,0,0,0.2);
                z-index: 10000;
                min-width: 150px;
            `;

            const menuItems = [
                { text: 'Â§çÂà∂ÂõæÁâáÂà∞Ââ™Ë¥¥Êùø', action: () => copyToClipboard(clipboardItem.content, 'image') },
                { text: '‰øùÂ≠òÂõæÁâá', action: () => downloadImage(clipboardItem.content) },
                { text: 'Âú®Êñ∞Á™óÂè£ÊâìÂºÄ', action: () => window.open(clipboardItem.content, '_blank') }
            ];

            menuItems.forEach(item => {
                const menuItem = document.createElement('div');
                menuItem.textContent = item.text;
                menuItem.style.cssText = `
                    padding: 8px 12px;
                    cursor: pointer;
                    border-bottom: 1px solid #eee;
                    font-size: 14px;
                `;
                menuItem.addEventListener('mouseenter', () => {
                    menuItem.style.background = '#f5f5f5';
                });
                menuItem.addEventListener('mouseleave', () => {
                    menuItem.style.background = 'white';
                });
                menuItem.addEventListener('click', () => {
                    item.action();
                    menu.remove();
                });
                menu.appendChild(menuItem);
            });

            document.body.appendChild(menu);

            // ÁÇπÂáªÂÖ∂‰ªñÂú∞ÊñπÂÖ≥Èó≠ËèúÂçï
            setTimeout(() => {
                document.addEventListener('click', function closeMenu() {
                    menu.remove();
                    document.removeEventListener('click', closeMenu);
                });
            }, 100);
        }

        // ‰∏ãËΩΩÂõæÁâá
        function downloadImage(imageSrc) {
            const link = document.createElement('a');
            link.href = imageSrc;
            link.download = `clipboard-image-${Date.now()}.png`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            showTooltip('ÂõæÁâáÂ∑≤‰øùÂ≠òÔºÅ');
        }

        // ÊòæÁ§∫ÊèêÁ§∫Ê°Ü
        function showTooltip(message) {
            const tooltip = document.getElementById('tooltip');
            tooltip.textContent = message;
            tooltip.style.display = 'block';
            
            setTimeout(() => {
                tooltip.style.display = 'none';
            }, 2000);
        }

        // ËΩ¨‰πâHTML
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // ‰øùÂ≠òÊï∞ÊçÆÂà∞Êú¨Âú∞Â≠òÂÇ®
        function saveClipboardData() {
            try {
                localStorage.setItem('infinityClipboardData', JSON.stringify(clipboardItems));
                localStorage.setItem('infinityClipboardNextId', nextId.toString());
            } catch (error) {
                console.error('‰øùÂ≠òÊï∞ÊçÆÂ§±Ë¥•:', error);
            }
        }

        // ‰ªéÊú¨Âú∞Â≠òÂÇ®Âä†ËΩΩÊï∞ÊçÆ
        function loadClipboardData() {
            try {
                const savedData = localStorage.getItem('infinityClipboardData');
                const savedNextId = localStorage.getItem('infinityClipboardNextId');
                
                if (savedData) {
                    clipboardItems = JSON.parse(savedData);
                }
                
                if (savedNextId) {
                    nextId = parseInt(savedNextId);
                }
            } catch (error) {
                console.error('Âä†ËΩΩÊï∞ÊçÆÂ§±Ë¥•:', error);
                clipboardItems = [];
                nextId = 1;
            }
        }

        // ÊòæÁ§∫‰ΩøÁî®ËØ¥Êòé
        function showHelp() {
            const helpText = `
Âø´Êç∑ÈîÆËØ¥ÊòéÔºö
‚Ä¢ Ctrl+V: Á≤òË¥¥ÂÜÖÂÆπ
‚Ä¢ Ctrl+F: ËÅöÁÑ¶ÊêúÁ¥¢Ê°Ü
‚Ä¢ Esc: Ê∏ÖÁ©∫ÊêúÁ¥¢
‚Ä¢ ÁÇπÂáªÈ°πÁõÆ: Â§çÂà∂ÂÜÖÂÆπÂà∞Ââ™Ë¥¥Êùø

ÂäüËÉΩËØ¥ÊòéÔºö
‚Ä¢ ÊîØÊåÅÊñáÊú¨„ÄÅ‰ª£Á†Å„ÄÅÂõæÁâáÁ≤òË¥¥
‚Ä¢ Ëá™Âä®Ê£ÄÊµã‰ª£Á†ÅÁ±ªÂûã
‚Ä¢ Êú¨Âú∞Â≠òÂÇ®ÔºåÊï∞ÊçÆÂÆâÂÖ®
‚Ä¢ ÊêúÁ¥¢ÂäüËÉΩÂø´ÈÄüÂÆö‰Ωç
‚Ä¢ ÊîØÊåÅÊï∞ÊçÆÂØºÂÖ•ÂØºÂá∫

ÂõæÁâáÂ§ÑÁêÜÔºö
‚Ä¢ Âè≥ÈîÆÁÇπÂáªÂõæÁâáÂèØÂ§çÂà∂ÂõæÁâáÂà∞Ââ™Ë¥¥Êùø
‚Ä¢ ÊîØÊåÅ‰øùÂ≠òÂõæÁâáÂà∞Êú¨Âú∞
‚Ä¢ ÊîØÊåÅÂú®Êñ∞Á™óÂè£ÊâìÂºÄÂõæÁâá
            `;
            alert(helpText);
        }

        // È°µÈù¢Âä†ËΩΩÂÆåÊàêÂêéÊòæÁ§∫Ê¨¢Ëøé‰ø°ÊÅØ
        window.addEventListener('load', function() {
            if (clipboardItems.length === 0) {
                showTooltip('Ê¨¢Ëøé‰ΩøÁî®Êó†ÈôêÂâ™Ë¥¥ÊùøÔºÅÊåâ Ctrl+V ÂºÄÂßãÁ≤òË¥¥ÂÜÖÂÆπ');
            }
        });
    </script>
</body>
</html> 